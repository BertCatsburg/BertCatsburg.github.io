"use strict";(self.webpackChunkdocusaurus_bertcatsburg=self.webpackChunkdocusaurus_bertcatsburg||[]).push([[684],{3905:(e,t,n)=>{n.d(t,{Zo:()=>d,kt:()=>h});var r=n(7294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var l=r.createContext({}),c=function(e){var t=r.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},d=function(e){var t=c(e.components);return r.createElement(l.Provider,{value:t},e.children)},u="mdxType",p={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},m=r.forwardRef((function(e,t){var n=e.components,i=e.mdxType,a=e.originalType,l=e.parentName,d=s(e,["components","mdxType","originalType","parentName"]),u=c(n),m=i,h=u["".concat(l,".").concat(m)]||u[m]||p[m]||a;return n?r.createElement(h,o(o({ref:t},d),{},{components:n})):r.createElement(h,o({ref:t},d))}));function h(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var a=n.length,o=new Array(a);o[0]=m;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s[u]="string"==typeof e?e:i,o[1]=s;for(var c=2;c<a;c++)o[c]=n[c];return r.createElement.apply(null,o)}return r.createElement.apply(null,n)}m.displayName="MDXCreateElement"},1257:(e,t,n)=>{n.d(t,{r:()=>i,I:()=>o});var r=n(7294);const i=e=>r.createElement("a",{href:e.to,target:"_blank"},e.children),a=[{description:"smiling face with open mouth",value:"\ud83d\ude03"},{description:"winking face",value:"\ud83d\ude09"},{description:"face with stuck-out tongue and winking eye",value:"\ud83d\ude1c"},{description:"astonished face",value:"\ud83d\ude32"},{description:"white heavy check mark",value:"\u2705"}],o=e=>{const t=a.find((t=>t.description===e.description));return t?t.value:null}},4242:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>o,default:()=>p,frontMatter:()=>a,metadata:()=>s,toc:()=>c});var r=n(7462),i=(n(7294),n(3905));n(1257);const a={sidebar_position:5},o="Domainnames and SSL",s={unversionedId:"nginx-in-docker/dns-and-ssl",id:"nginx-in-docker/dns-and-ssl",title:"Domainnames and SSL",description:"Now that we have configured the static website in our ProxyServer, we need to talk about Domainnames and SSL.",source:"@site/docs/nginx-in-docker/05-dns-and-ssl.mdx",sourceDirName:"nginx-in-docker",slug:"/nginx-in-docker/dns-and-ssl",permalink:"/docs/nginx-in-docker/dns-and-ssl",draft:!1,tags:[],version:"current",sidebarPosition:5,frontMatter:{sidebar_position:5},sidebar:"tutorialSidebar",previous:{title:"Setting up a Static Website",permalink:"/docs/nginx-in-docker/static-website"},next:{title:"Databases",permalink:"/docs/nginx-in-docker/database"}},l={},c=[{value:"Where to place the certificates",id:"where-to-place-the-certificates",level:2},{value:"Changing the Nginx definition of static website",id:"changing-the-nginx-definition-of-static-website",level:2},{value:"Directory structure so far",id:"directory-structure-so-far",level:2},{value:"Domainnames",id:"domainnames",level:2},{value:"Advantage",id:"advantage",level:3}],d={toc:c},u="wrapper";function p(e){let{components:t,...a}=e;return(0,i.kt)(u,(0,r.Z)({},d,a,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"domainnames-and-ssl"},"Domainnames and SSL"),(0,i.kt)("p",null,"Now that we have configured the static website in our ProxyServer, we need to talk about Domainnames and SSL."),(0,i.kt)("p",null,"The ProxyServer will receive requests from the Internet. And those request will be coming in over port 443, the SSL Port."),(0,i.kt)("p",null,"It is the Nginx Server-configurations (in proxyserver/deployment/etc/nginx/conf.d) where the SSL\ncertificate needs to be specified.\nLike the default.conf of the static website we defined in the previous paragraph."),(0,i.kt)("h2",{id:"where-to-place-the-certificates"},"Where to place the certificates"),(0,i.kt)("p",null,"Since the ProxyServer needs those certificates, lets place them in the proxyserver directory of the deployment project.\nI am putting them in ",(0,i.kt)("strong",{parentName:"p"},"proxyserver/deployment/etc/ssl/private"),"."),(0,i.kt)("h2",{id:"changing-the-nginx-definition-of-static-website"},"Changing the Nginx definition of static website"),(0,i.kt)("p",null,"To implement the SSL Certificates, the static_website.conf (or what name you've given it) Nginx config file needs to be changed:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"server {\n    listen 443 ssl;\n    listen [::]:443 ssl;\n    server_name www.mydomain.com;\n\n    ssl_certificate         /etc/ssl/private/star_mydomain_com_full_chain.txt;\n    ssl_certificate_key     /etc/ssl/private/star_mydomain_com.key;\n\n    access_log      /var/log/nginx/www_mydomain_access.log  main;\n    error_log       /var/log/nginx/www_mydomain_error.log;\n\n    location / {\n        proxy_pass      http://172.30.0.20:7777;\n    }\n}\n")),(0,i.kt)("p",null,"It shows the proxyserver will only listen to port 443 for this domain."),(0,i.kt)("h2",{id:"directory-structure-so-far"},"Directory structure so far"),(0,i.kt)("p",null,"With all these files, lets do a recap of which files we have now in our Deployment Project:\n",(0,i.kt)("img",{alt:"Directory Structure",src:n(8573).Z,width:"730",height:"1542"})),(0,i.kt)("p",null,"And if you collapse all directory but the main ones, you see where we are going: 1 Directory for each Docker Container"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"proxyserver"),(0,i.kt)("li",{parentName:"ul"},"staticsite")),(0,i.kt)("p",null,'Then, last section before we are going to create more Containers: "Domainnames"'),(0,i.kt)("h2",{id:"domainnames"},"Domainnames"),(0,i.kt)("p",null,"The proxyserver is listening to port 443 and domainname ",(0,i.kt)("a",{parentName:"p",href:"http://www.mydomain.com"},"www.mydomain.com"),"."),(0,i.kt)("p",null,"But we will have many more subdomains or other domains in out deployment. For example:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"api-production.mydomain.com (Written in NodeJS)"),(0,i.kt)("li",{parentName:"ul"},"api-devevelopment.mydomain.com (Written in NodeJS)"),(0,i.kt)("li",{parentName:"ul"},"microservice-handling-images.mydomain.com (Written in Python FastAPI)"),(0,i.kt)("li",{parentName:"ul"},"app.mydomain.com (The UI written in ReactJS)")),(0,i.kt)("p",null,"All these domains are set up at our Hosting Provider and all pointing to the Host we are working on."),(0,i.kt)("h3",{id:"advantage"},"Advantage"),(0,i.kt)("p",null,"The big advantage is that moving Containers around to other Hosts is a very easy task:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"'git pull' the whole deployment project on another Host"),(0,i.kt)("li",{parentName:"ul"},"Start proxyserver there"),(0,i.kt)("li",{parentName:"ul"},"Start the containers there (only the ones which need to run on this host)"),(0,i.kt)("li",{parentName:"ul"},"Flip the IP addresses of these (sub)domains at your Domainname-provider.")),(0,i.kt)("p",null,"If the same Container is also running at another Host, no harm done, because that other host just does not get\nthe requests since the domainname is not pointing to that host."))}p.isMDXComponent=!0},8573:(e,t,n)=>{n.d(t,{Z:()=>r});const r=n.p+"assets/images/directory-structure-02-ee0e31d61dd93d80d00f029d274213de.png"}}]);